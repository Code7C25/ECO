<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ECO - Acceso Psic√≥logo</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <style>
    /* üè† Bot√≥n de inicio */
    .home-btn {
      background-color: white;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: 20px;
      left: 20px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.2);
      cursor: pointer;
      transition: 0.3s;
    }

    .home-btn:hover {
      transform: scale(1.05);
    }
  </style>
</head>

<body class="pagina-psicologo">
  <!-- Bot√≥n de inicio y correcion volver segun origen -->
  <div class="home-btn" onclick="volverSegunOrigen()">
    <img src="home-icon.png" alt="Inicio" style="width:28px; height:28px; opacity:0.8;">
  </div>

  <main>
    <h2>Acceso para psic√≥logos</h2>
    <div id="psicoForm">
      <input id="psicoDNI" type="text" placeholder="DNI" />
      <input id="psicoClave" type="password" placeholder="Contrase√±a" />
      <button id="psicoBtn">Ingresar</button>
      <p id="psicoMsg"></p>
    </div>

    <div id="psicoDenied" style="display:none; text-align:center;">
      <h3>Acceso denegado</h3>
      <p>No ten√©s permisos para ver esta secci√≥n.</p>
      <button onclick="window.location.href='index.html'">Volver</button>
    </div>
  </main>

  <script src="menu.js"></script>
  <script src="firebase.js"></script>


  <script>
  document.getElementById("psicoBtn").addEventListener("click", async () => {
    const dni = document.getElementById("psicoDNI").value.trim();
    const clave = document.getElementById("psicoClave").value.trim();
    const msg = document.getElementById("psicoMsg");
    const denied = document.getElementById("psicoDenied");
    const form = document.getElementById("psicoForm");

    msg.textContent = "";
    msg.style.color = "red";

    if (!/^\d{7,8}$/.test(dni)) {
      msg.textContent = "El DNI debe tener solo n√∫meros (7 u 8 d√≠gitos).";
      return;
    }

  
    if (clave.length < 6) {
      msg.textContent = "La contrase√±a debe tener al menos 6 caracteres.";
      return;
    }

    try {

      const query = await firebase.firestore()
        .collection("psicologos")
        .where("dni", "==", dni)
        .where("clave", "==", clave)
        .get();

      if (!query.empty) {
        msg.style.color = "green";
        msg.textContent = "Acceso concedido ‚úÖ";
        localStorage.setItem("psicoDNI", dni);

        setTimeout(() => {
          window.location.href = "psicologo_panel.html"; 
        }, 1000);
      } else {
        <!-- Si no coincide, muestra el mensaje de acceso denegado -->
        form.style.display = "none";
        denied.style.display = "block";
      }
    } catch (error) {
      msg.textContent = "Error al conectar con la base de datos.";
    }
  });
  </script>
  <script>
  /* =============================
        BOT√ìN HOME ‚Üí Volver al inicio
     ============================= */
  function volverSegunOrigen() {
    window.location.href = "index.html";
  }
</script>


</body>
</html>
